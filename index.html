
<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>eSIM Mongolia</title>
  <meta name="description" content="eSIM Mongolia ‚Äî —É–ª—Å–∞–∞ —Å–æ–Ω–≥–æ–æ–¥ –¥–∞—Ç–∞/—Ö—É–≥–∞—Ü–∞–∞–≥–∞–∞ —Å–æ–Ω–≥–æ. " />

  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --text:#111827; --muted:#6b7280;
      --brand:#10b981; --border:#e5e7eb;
      --shadow:0 12px 40px rgba(0,0,0,.12);
      --r:18px;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:var(--text); }
    a{ color:inherit; }
    .wrap{ max-width:1100px; margin:0 auto; padding:16px; }
    .nav{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px 0; }
    .right{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      border:1px solid var(--border); background:#fff; color:var(--text);
      padding:10px 12px; border-radius:12px; font-weight:900; cursor:pointer;
      text-decoration:none;
    }
    .btn.primary{ background:var(--brand); border-color:var(--brand); color:#fff; }
    .pill{
      border:1px solid var(--border); background:#fff; padding:8px 10px; border-radius:999px;
      font-weight:900; cursor:pointer;
    }
    .pill.active{ background:var(--brand); color:#fff; border-color:var(--brand); }
    h1{ font-size:22px; margin:14px 0 6px; }
    h2{ font-size:18px; margin:18px 0 10px; }
    .sub{ color:var(--muted); font-size:13px; line-height:1.5; }
    .controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:12px 0 10px; }
    .search{ width:min(420px, 78vw); border:1px solid var(--border); border-radius:12px; padding:10px 12px; }
    .select{ border:1px solid var(--border); border-radius:12px; padding:10px 12px; background:#fff; font-weight:900; }

    .grid{ display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; }
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--r);
      padding:14px; box-shadow:0 1px 0 rgba(0,0,0,.02);
    }
    .cardHead{ display:flex; justify-content:space-between; gap:10px; align-items:flex-start; }
    .name{ font-weight:900; }
    .note{ margin-top:10px; font-size:13px; }

    .featuredGrid{ display:grid; grid-template-columns:repeat(3, 1fr); gap:14px; }
    .featuredCard{ background:var(--card); border:1px solid var(--border); border-radius:var(--r); padding:14px; box-shadow:var(--shadow); }
    .featuredCard h3{ margin:10px 0 4px; font-size:16px; }
    .imgWrap img{ width:100%; height:160px; object-fit:cover; border-radius:14px; display:block; }

    details{ background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px 14px; }
    summary{ cursor:pointer; font-weight:900; }

    .footer{ margin-top:22px; background:#0b1220; color:#e5e7eb; border-radius:18px; padding:18px; }
    .footer a{ color:#e5e7eb; }

    /* Modal */
    .bd{ position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; z-index:99998; }
    .md{
      position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
      width:min(640px,92vw); background:#fff; border-radius:18px; box-shadow:var(--shadow);
      display:none; z-index:99999; overflow:hidden;
    }
    .md header{ padding:14px 16px; border-bottom:1px solid #eef2f7; display:flex; justify-content:space-between; align-items:center; gap:10px; }
    .close{ border:0; background:transparent; font-size:22px; cursor:pointer; color:var(--muted); }
    .md .body{ padding:14px 16px; line-height:1.65; }
    .actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:12px; flex-wrap:wrap; }

    /* Toast */
    .toast{
      position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
      background:#111827; color:#fff; padding:10px 12px; border-radius:12px;
      box-shadow:0 10px 26px rgba(0,0,0,.25);
      display:none; z-index:100000;
      font-weight:800; font-size:13px;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns:1fr; }
      .featuredGrid{ grid-template-columns:1fr; }
      .imgWrap img{ height:170px; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="nav">
      <!-- Navbar Logo: eSIMMongolia Page (ID –∞—à–∏–≥–ª–∞—Å–∞–Ω) -->
      <a href="https://www.facebook.com/profile.php?id=61587287992719"
         target="_blank"
         style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;font-weight:900;letter-spacing:.2px">
        <img src="https://graph.facebook.com/61587287992719/picture?type=large"
             alt="eSIMMongolia"
             style="width:40px;height:40px;border-radius:50%;object-fit:cover">
        <span>eSIM Mongolia</span>
      </a>

      <div class="right">
        <span class="sub" style="font-weight:900">üìû 90283039</span>
        <a class="btn" href="#pricing">“Æ–Ω—ç</a>
        <a class="btn" href="#faq">FAQ</a>
        <button class="btn primary" id="quickChinaBtn" type="button">üá®üá≥ China</button>
      </div>
    </div>

    <h1>–ê—è–ª–ª—ã–Ω eSIM ‚Äî —É–ª—Å–∞–∞ —Å–æ–Ω–≥–æ–æ–¥ –¥–∞—Ç–∞/—Ö—É–≥–∞—Ü–∞–∞–≥–∞–∞ —Å–æ–Ω–≥–æ</h1>
    <div class="sub">
      –¢–∞ –∞—è–ª ‚Äî –±–∏–¥—ç–Ω–¥ –¥–∞—Ç–∞–≥aa –¥–∞–∞—Ç–≥–∞. <b>eSIMMongolia</b> —Ç–∞–Ω—å—Ç–∞–π —Ö–∞–º—Ç, —Ç–∞–Ω—ã —Ö—ç—Ä—ç–≥–ª—ç—ç–≥ —Ç–∞—Å—Ä–∞–ª—Ç–≥“Ø–π —Ö–∞–Ω–≥–∞–Ω–∞.<br>
      ‚úàÔ∏è –≠–¥–≥—ç—ç—Ä —É–ª—Å—É—É–¥ —Ä—É—É –∞—è–ª–∞—Ö—ã–≥ —Ö“Ø—Å–≤—ç–ª <b><a href="https://www.facebook.com/chukatravel" target="_blank">ChukaTravel</a></b> page —Ä—É—É —Ö–∞–Ω–¥–∞–Ω–∞ —É—É.
    </div>

    <!-- ‚≠ê Featured (3 images - online URLs) -->
    <h2>‚≠ê –û–Ω—Ü–ª–æ—Ö –±–∞–≥—Ü—É—É–¥</h2>
    <div class="featuredGrid">
      <div class="featuredCard">
        <div class="imgWrap">
          <img src="https://images.unsplash.com/photo-1549692520-acc6669e2f0c?auto=format&fit=crop&w=1200&q=80"
               alt="China eSIM" loading="lazy">
        </div>
        <h3>üá®üá≥ –•—è—Ç–∞–¥ eSIM</h3>
        <p class="sub">Facebook, Google VPN-–≥“Ø–π (HK routed)</p>
        <button class="btn primary" type="button" onclick="quickOpen('cn')">“Æ–Ω—ç —Ö–∞—Ä–∞—Ö</button>
      </div>

      <div class="featuredCard">
        <div class="imgWrap">
          <img src="https://images.unsplash.com/photo-1500835556837-99ac94a94552?auto=format&fit=crop&w=1200&q=80"
               alt="Asia eSIM" loading="lazy">
        </div>
        <h3>üåè Asia (10 —É–ª—Å)</h3>
        <p class="sub">–ê–∑–∏–π–Ω 10 —É–ª—Å–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞</p>
        <button class="btn primary" type="button" onclick="quickOpen('asia10')">“Æ–Ω—ç —Ö–∞—Ä–∞—Ö</button>
      </div>

      <div class="featuredCard">
        <div class="imgWrap">
          <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1200&q=80"
               alt="Global eSIM" loading="lazy">
        </div>
        <h3>üåç Global (66 —É–ª—Å)</h3>
        <p class="sub">–î—ç–ª—Ö–∏–π–Ω 66 —É–ª—Å–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞</p>
        <button class="btn primary" type="button" onclick="quickOpen('global66')">“Æ–Ω—ç —Ö–∞—Ä–∞—Ö</button>
      </div>
    </div>

    <!-- Pricing -->
    <h2 id="pricing">üåç –£–ª—Å / –ë“Ø—Å —Å–æ–Ω–≥–æ–æ–¥ “Ø–Ω—ç –±–æ–¥–æ–æ—Ä–æ–π</h2>

    <div class="controls">
      <input id="q" class="search" placeholder="–£–ª—Å —Ö–∞–π—Ö‚Ä¶ (Japan, Europe, USA, Global –≥—ç—Ö –º—ç—Ç)" />
      <select id="days" class="select"></select>
      <button class="btn" id="clear" type="button">Clear</button>
    </div>

    <div class="grid" id="grid"></div>

    <!-- FAQ -->
    <h2 id="faq">FAQ</h2>
    <div style="display:grid; gap:10px;">
      <details>
        <summary>–•—è—Ç–∞–¥ eSIM “Ø–Ω—ç—Ö—ç—ç—Ä Facebook/Google –Ω—ç—ç—Ö “Ø“Ø?</summary>
        <div class="sub" style="margin-top:8px">
          ‚Äú–•—è—Ç–∞–¥‚Äù –¥—ç—ç—Ä —Ç—ç–º–¥—ç–≥–ª—ç—Å—ç–Ω HK routed –±–∞–≥—Ü –±–æ–ª VPN-–≥“Ø–π –Ω—ç—ç—Ö –±–æ–ª–æ–º–∂—Ç–æ–π. –≠—Ü—Å–∏–π–Ω –±–∞—Ç–∞–ª–≥–∞–∞–∂—É—É–ª–∞–ª—Ç—ã–≥ —á–∞—Ç–∞–∞—Ä —Ö–∏–π–Ω—ç.
        </div>
      </details>
      <details>
        <summary>“Æ–ô–õ–ß–ò–õ–ì–≠–≠–ù–ò–ô –ù”®–•–¶”®–õ

–ï—Ä”©–Ω—Ö–∏–π –∑“Ø–π–ª

–≠–Ω—ç—Ö“Ø“Ø “Ø–π–ª—á–∏–ª–≥—ç—ç–Ω–∏–π –Ω”©—Ö—Ü”©–ª –Ω—å esimmongolia –≤—ç–± —Å–∞–π—Ç–∞–∞—Ä –¥–∞–º–∂—É—É–ª–∞–Ω eSIM “Ø–π–ª—á–∏–ª–≥—ç—ç –∞–≤–∞—Ö—Ç–∞–π —Ö–æ–ª–±–æ–æ—Ç–æ–π —Ö—ç—Ä—ç–≥–ª—ç–≥—á –±–æ–ª–æ–Ω amarsim.mn –≤—ç–± —Å–∞–π—Ç —Ö–æ–æ—Ä–æ–Ω–¥—ã–Ω —Ö–∞—Ä–∏–ª—Ü–∞–∞–≥ –∑–æ—Ö–∏—Ü—É—É–ª–Ω–∞. –•—ç—Ä—ç–≥–ª—ç–≥—á eSIM “Ø–π–ª—á–∏–ª–≥—ç—ç–≥ –∞–≤–∞—Ö—ã–Ω ”©–º–Ω”© —ç–Ω—ç—Ö“Ø“Ø –ù”©—Ö—Ü”©–ª–∏–π–≥ –∞–Ω—Ö–∞–∞—Ä–∞–ª—Ç–∞–π —É–Ω—à–∏–∂, –∑”©–≤—à”©”©—Ä—Å”©–Ω –±–∞–π–Ω–∞. –í—ç–± —Å–∞–π—Ç–∞–∞—Ä “Ø–π–ª—á–∏–ª–≥—ç—ç –∞–≤–∞—Ö, –∑–∞—Ö–∏–∞–ª–≥–∞ ”©–≥”©—Ö, —ç—Å–≤—ç–ª eSIM –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö –Ω—å —É–≥  –Ω”©—Ö—Ü”©–ª–∏–π–≥ —Ö“Ø–ª—ç—ç–Ω –∑”©–≤—à”©”©—Ä—Å–Ω–∏–π–≥ –∏–ª—ç—Ä—Ö–∏–π–ª–Ω—ç.

1. eSIM “Ø–π–ª—á–∏–ª–≥—ç—ç–Ω–∏–π —Ç–æ–¥–æ—Ä—Ö–æ–π–ª–æ–ª—Ç

eSIM –Ω—å –±–∏–µ—Ç SIM –∫–∞—Ä—Ç —à–∞–∞—Ä–¥–ª–∞–≥–∞–≥“Ø–π, –¥–∏–∂–∏—Ç–∞–ª —Ö—ç–ª–±—ç—Ä–∏–π–Ω SIM –∫–∞—Ä—Ç –±”©–≥”©”©–¥ –≤—ç–± —Å–∞–π—Ç–∞–∞—Ä –¥–∞–º–∂—É—É–ª–∞–Ω QR –∫–æ–¥ –∞—à–∏–≥–ª–∞–Ω –≥–∞–¥–∞–∞–¥ —É–ª—Å–∞–¥ –¥–∞—Ç–∞ “Ø–π–ª—á–∏–ª–≥—ç—ç –∞—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂–∏–π–≥ –æ–ª–≥–æ–¥–æ–≥ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏ —é–º.
eSIM “Ø–π–ª—á–∏–ª–≥—ç—ç –Ω—å –≥–∞–¥–∞–∞–¥ —É–ª—Å–∞–¥ –¥–∞—Ç–∞ –∞—à–∏–≥–ª–∞—Ö (2G/3G/4G/5G) “Ø–π–ª—á–∏–ª–≥—ç—ç–≥ —Ö–∞–º–∞—Ä–Ω–∞.
eSIM-–≥ –∑”©–≤—Ö”©–Ω eSIM —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π–≥ –¥—ç–º–∂–¥—ç–≥ —Ç”©—Ö”©”©—Ä”©–º–∂ –¥—ç—ç—Ä (–∂–∏—à—ç—ç: iPhone XS –±–∞ —Ç“Ø“Ø–Ω—ç—ç—Å —Ö–æ–π—à, Samsung Galaxy S20 –±–∞ —Ç“Ø“Ø–Ω—ç—ç—Å —Ö–æ–π—à) –∞—à–∏–≥–ª–∞–Ω–∞.
2. “Æ–π–ª—á–∏–ª–≥—ç—ç –∞–≤–∞—Ö–∞–¥ —Ç–∞–≤–∏–≥–¥–∞—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞

2.1. –¢”©—Ö”©”©—Ä”©–º–∂–∏–π–Ω –Ω–∏–π—Ü—Ç—ç–π –±–∞–π–¥–∞–ª: –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —É—Ç–∞—Å eSIM-–≥ –¥—ç–º–∂–¥—ç–≥ –±–∞–π—Ö —ë—Å—Ç–æ–π. –®–∞–ª–≥–∞—Ö—ã–Ω —Ç—É–ª–¥ *#06# –¥—É–≥–∞–∞—Ä—Ç –∑–∞–ª–≥–∞–∂, EID –∫–æ–¥ –≥–∞—Ä—á –∏—Ä–≤—ç–ª —Ç—É—Ö–∞–π–Ω —É—Ç–∞—Å eSIM-–≥ –¥—ç–º–∂–¥—ç–≥ –≥—ç–¥–≥–∏–π–Ω —Ö–∞—Ä—É—É–ª–Ω–∞.
2.2. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ö–æ–ª–±–æ–ª—Ç: eSIM –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö—ç–¥ Wi-Fi —Ö–æ–ª–±–æ–ª—Ç —ç—Å–≤—ç–ª —É—Ç–∞—Å–Ω—ã—Ö–∞–∞ –¥–∞—Ç–∞ —Ö–æ–ª–±–æ–ª—Ç—ã–≥ –∏–¥—ç–≤—Ö–∏–∂“Ø“Ø–ª—Å—ç–Ω –±–∞–π—Ö—à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π.
2.3. –ë“Ø—Ä—Ç–≥—ç–ª: –•—ç—Ä—ç–≥–ª—ç–≥—á esimmongolia –≤—ç–± —Å–∞–π—Ç–∞–¥ –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω—ç—ç—Ä —Ç—É—Å “Ø–π–ª—á–∏–ª–≥—ç—ç–≥ –∞—à–∏–≥–ª–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –±–æ–ª–Ω–æ. 

3. –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω “Ø“Ø—Ä—ç–≥

–¢–∞–Ω—å–¥ –∏–ª–≥—ç—ç—Å—ç–Ω –¥–∞—Ç–∞ “Ø–π–ª—á–∏–ª–≥—ç—ç–Ω–∏–π QR –∫–æ–¥—ã–≥ –±—É—Å–∞–¥—Ç–∞–π —Ö—É–≤–∞–∞–ª—Ü–∞—Ö–≥“Ø–π, –Ω—É—É—Ü–ª–∞–ª—ã–≥ —Ö–∞–¥–≥–∞–ª–Ω–∞.
–•—É–≤–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–≥ “Ø–Ω—ç–Ω –∑”©–≤ –æ—Ä—É—É–ª—Å–∞–Ω–∞–∞—Ä —Ç–∞–Ω—å–¥ –≥–∞–¥–∞–∞–¥–∞–¥ –∞—à–∏–≥–ª–∞—Ö –¥–∞—Ç–∞ –∏-—Å–∏–º–Ω–∏–π –º—ç–¥—ç—ç–ª—ç–ª “Ø–Ω—ç–Ω –∑”©–≤ –æ—á–∏—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –≥—ç–¥–≥–∏–π–≥ –∞–Ω—Ö–∞–∞—Ä–Ω–∞ —É—É 
eSIM –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö—ç–¥ —Ç–∞–Ω—ã –≥–∞—Ä —É—Ç–∞—Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ö–æ–ª–±–æ–ª—Ç—Ç–æ–π /Wifi —Ö–æ–ª–±–æ–ª—Ç —ç—Å–≤—ç–ª –≥–∞—Ä —É—Ç–∞—Å–Ω—ã –¥–∞—Ç–∞–≥ –∏–¥—ç–≤—Ö–∏–∂“Ø“Ø–ª—Å—ç–Ω/ –±–∞–π—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π.
–•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω eSIM-–∏–π–Ω —Ö“Ø—á–∏–Ω—Ç—ç–π —Ö—É–≥–∞—Ü–∞–∞ –¥—É—É—Å—Å–∞–Ω —ç—Å–≤—ç–ª —Ö—ç—Ä—ç–≥–ª—ç—ç–≥“Ø–π “Ø–ª–¥—ç–≥–¥—ç–ª–¥ –±—É—Ü–∞–∞–Ω –æ–ª–≥–æ–ª—Ç —Ö–∏–π–≥–¥—ç—Ö–≥“Ø–π.
–•—ç—Ä—ç–≥–ª—ç–≥—á —É—Ç–∞—Å–Ω–∞–∞—Å–∞–∞ QR –∫–æ–¥ —É—Å—Ç–≥–∞—Ö, –¥–∞—Ö–∏–Ω —Å—É—É–ª–≥–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π –±–æ–ª–≥–æ—Ö, eSIM-–∏–π–≥ –±—É—Ä—É—É —Ç”©—Ö”©”©—Ä”©–º–∂ –¥—ç—ç—Ä –∏–¥—ç–≤—Ö–∂“Ø“Ø–ª—ç—Ö —Ç–æ—Ö–∏–æ–ª–¥–æ–ª–¥ –±—É—Ü–∞–∞–Ω –æ–ª–≥–æ–ª—Ç —Ö–∏–π—Ö –±–æ–ª–æ–º–∂–≥“Ø–π
–•—ç—Ä—ç–≥–ª—ç–≥—á —Å–∏–º—ç—ç –∞—à–∏–≥–ª–∞–∂ —ç—Ö—ç–ª—Å—ç–Ω —Ç–æ—Ö–∏–æ–ª–¥–æ–ª–¥ –±—É—Ü–∞–∞–Ω –æ–ª–≥–æ–ª—Ç —Ö–∏–π–≥–¥—ç—Ö –±–æ–ª–æ–º–∂–≥“Ø–π
4. “Æ–π–ª—á–∏–ª–≥—ç—ç “Ø–∑“Ø“Ø–ª—ç–≥—á–∏–π–Ω —Ö–∞—Ä–∏—É—Ü–ª–∞–≥–∞

–î–∞—Ç–∞ —Å–∏–º –∞—à–∏–≥–ª–∞—Ö QR –∫–æ–¥—ã–≥ —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω –∏–º—ç–π–ª —Ö–∞—è–≥ —Ä—É—É —ç—Å–≤—ç–ª QR –∫–æ–¥—ã–Ω –ª–∏–Ω–∫–∏–π–≥ —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –±“Ø—Ä—Ç–≥“Ø“Ø–ª—Å—ç–Ω –≥–∞—Ä —É—Ç–∞—Å —Ä—É—É –∏–ª–≥—ç—ç–Ω—ç.
eSIM “Ø–π–ª—á–∏–ª–≥—ç—ç–Ω–∏–π —Ç–∞—Å—Ä–∞–ª—Ç–≥“Ø–π, –Ω–∞–π–¥–≤–∞—Ä—Ç–∞–π –∞–∂–∏–ª–ª–∞–≥–∞–∞–≥ —Ö–∞–Ω–≥–∞–Ω–∞.
–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ö—É–≤–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–Ω –Ω—É—É—Ü–ª–∞–ª—ã–≥ –ú–æ–Ω–≥–æ–ª –£–ª—Å—ã–Ω —Ö—É—É–ª—å —Ç–æ–≥—Ç–æ–æ–º–∂–∏–π–Ω –¥–∞–≥—É—É —Ö–∞–º–≥–∞–∞–ª–Ω–∞.
–í—ç–± —Å–∞–π—Ç—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª, “Ø–Ω—ç,, —Ö—É–≥–∞—Ü–∞–∞–Ω—ã “Ø–Ω—ç–Ω –∑”©–≤ –±–∞–π–¥–ª—ã–≥ —Ö–∞—Ä–∏—É—Ü–Ω–∞.
5. –ù—É—É—Ü–ª–∞–ª –±–∞ –∞—é—É–ª–≥“Ø–π –±–∞–π–¥–∞–ª

–•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∏–º—ç–π–ª —Ö–∞—è–≥, –≥–∞—Ä —É—Ç–∞—Å–Ω—ã –¥—É–≥–∞–∞—Ä, —Ç”©–ª–±”©—Ä–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–≥ –∑”©–≤—Ö”©–Ω “Ø–π–ª—á–∏–ª–≥—ç—ç “Ø–∑“Ø“Ø–ª—ç—Ö –∑–æ—Ä–∏–ª–≥–æ–æ—Ä –∞—à–∏–≥–ª–∞–Ω–∞.
–í—ç–± —Å–∞–π—Ç –Ω—å –∑”©–≤—à”©”©—Ä”©–ª–≥“Ø–π —Ö–∞–Ω–¥–ª–∞–≥–∞–∞—Å —Ö–∞–º–≥–∞–∞–ª–∞–≥–¥—Å–∞–Ω –±”©–≥”©”©–¥ —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –º—ç–¥—ç—ç–ª–ª–∏–π–Ω –∞—é—É–ª–≥“Ø–π –±–∞–π–¥–ª—ã–≥ —Ö–∞–Ω–≥–∞–Ω–∞.
6. –°–∞–Ω–∞–ª –≥–æ–º–¥–æ–ª

–•—ç—Ä—ç–≥–ª—ç–≥—á “Ø–π–ª—á–∏–ª–≥—ç—ç–Ω–∏–π —Ç–∞–ª–∞–∞—Ä —Å–∞–Ω–∞–ª, –≥–æ–º–¥–ª–æ–æ  esimmongolia, 90283039 –¥—É–≥–∞–∞—Ä—Ç —Ö–æ–ª–±–æ–≥–¥–æ—Ö —ç—Å–≤—ç–ª  WhatsApp  “Ø–π–ª—á–∏–ª–≥—ç—ç–≥—ç—ç—Ä –∏–ª–≥—ç—ç–Ω—ç.
7. –•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö

–õ–∞–≤–ª–∞—Ö –¥—É–≥–∞–∞—Ä: +976-90283039
–í—ç–±—Å–∞–π—Ç: esimmongolia.com</summary>
        <div class="sub" style="margin-top:8px">
          <b>‚Äú–•—è—Ç–∞–¥ —è–≤–∞—Ö —É—É? Facebook, Google VPN-–≥“Ø–π ‚Äî QR –∫–æ–¥ 5 –º–∏–Ω—É—Ç–∞–Ω–¥.‚Äù</b>
        </div>
      </details>
    </div>

    <div class="footer">
      <div style="font-weight:900;font-size:16px">eSIMMongolia</div>
      <div style="opacity:.9;margin-top:6px">üìû –•–æ–ª–±–æ–æ –±–∞—Ä–∏—Ö: <b>90283039</b></div>
      <div style="opacity:.9;margin-top:8px">
        ‚úàÔ∏è –•—è—Ç–∞–¥, –¢–∞–π–ª–∞–Ω–¥, –Ø–ø–æ–Ω, –°–æ–ª–æ–Ω–≥–æ—Å –±–æ–ª–æ–Ω –±—É—Å–∞–¥ —É–ª—Å —Ä—É—É –∞—è–ª–∞—Ö –±–æ–ª üëâ
        <a href="https://www.facebook.com/chukatravel" target="_blank"><b>ChukaTravel Facebook Page</b></a>
      </div>
      <div style="opacity:.75;margin-top:10px">¬© 2026 eSIMMongolia</div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast">–•—É—É–ª–ª–∞–∞ ‚úÖ</div>

  <!-- Modal -->
  <div class="bd" id="bd"></div>
  <div class="md" id="md" role="dialog" aria-modal="true">
    <header>
      <b id="ttl">“Æ–Ω–∏–π–Ω —Å–∞–Ω–∞–ª</b>
      <button class="close" id="x" type="button" aria-label="Close">√ó</button>
    </header>

    <div class="body">
      <div id="out"></div>

      <!-- Data selector -->
      <div style="margin-top:12px">
        <div class="sub" style="margin-bottom:8px">–î–∞—Ç–∞ —Å–æ–Ω–≥–æ—Ö</div>
        <div id="dataChips" style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="pill" data-plan="1" type="button">1GB</button>
          <button class="pill" data-plan="2" type="button">2GB</button>
          <button class="pill" data-plan="3" type="button">3GB</button>
          <button class="pill" data-plan="unl" type="button">Unlimited</button>
        </div>
        <div style="margin-top:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <span class="sub">—ç—Å–≤—ç–ª</span>
          <select id="modalPlan" class="select">
            <option value="1">1GB</option>
            <option value="2">2GB</option>
            <option value="3">3GB</option>
            <option value="unl">Unlimited</option>
          </select>
        </div>
      </div>

      <!-- Day chips + dropdown -->
      <div style="margin-top:12px">
        <div class="sub" style="margin-bottom:8px">–•–æ–Ω–æ–≥ —Å–æ–Ω–≥–æ—Ö</div>

        <div id="dayChips" style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="pill" data-d="1"  type="button">1</button>
          <button class="pill" data-d="3"  type="button">3</button>
          <button class="pill" data-d="5"  type="button">5</button>
          <button class="pill" data-d="7"  type="button">7</button>
          <button class="pill" data-d="10" type="button">10</button>
          <button class="pill" data-d="15" type="button">15</button>
          <button class="pill" data-d="30" type="button">30</button>
        </div>

        <div style="margin-top:10px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <span class="sub">—ç—Å–≤—ç–ª</span>
          <select id="modalDays" class="select"></select>
        </div>
      </div>

            <div class="actions" style="justify-content:space-between">
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" id="payQpay" type="button">QPay-—Ä —Ç”©–ª”©—Ö</button>
          <button class="btn" id="checkPayment" type="button">–¢”©–ª–±”©—Ä —à–∞–ª–≥–∞—Ö</button>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end">
          <button class="btn" id="cancel" type="button">–ë–æ–ª–∏—Ö</button>
          <!-- –ó–∞—Ö–∏–∞–ª–∞—Ö: Messenger —Ä“Ø“Ø “Ø—Å—Ä—ç—Ö–≥“Ø–π. –°–æ–Ω–≥–æ–ª—Ç—ã–≥ —Ö—É—É–ª–∂ ”©–≥–Ω”©. -->
          <button class="btn" id="order" type="button">–ó–∞—Ö–∏–∞–ª–≥—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ö—É—É–ª–Ω–∞</button>
        </div>
      </div>

      <div id="qpayBox" style="margin-top:12px"></div>

      <div id="chatBtns" style="margin-top:10px; display:none; gap:10px; flex-wrap:wrap">
        <a class="btn primary" id="goWhatsapp" target="_blank" rel="noopener">WhatsApp —Ä—É—É –±–∏—á–∏—Ö</a>
        <a class="btn" id="goMessenger" target="_blank" rel="noopener">Facebook Page —Ä—É—É –±–∏—á–∏—Ö</a>
      </div>

      <div class="sub" style="margin-top:10px">
        * –î“Ø–Ω –Ω—å —Å–æ–Ω–≥–æ—Å–æ–Ω —Ö–æ–Ω–æ–≥/–¥–∞—Ç–∞–≥–∞–∞—Ä –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä —à–∏–Ω—ç—á–ª—ç–≥–¥—ç–Ω—ç.
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    // =========================
    // CONFIG (–¥–æ—Ç–æ–æ–¥ —Ç–æ–æ—Ü–æ–æ ‚Äì —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ —Ö–∞—Ä—É—É–ª–∞—Ö–≥“Ø–π)
    // =========================
    const PROFIT = 0.30;        // –∞—à–∏–≥ (UI –¥—ç—ç—Ä –±–∏—á–∏—Ö–≥“Ø–π)
    const DAILY_DISC = 0.005;   // ”©–¥”©—Ä –±“Ø—Ä 0.5% —Ö—è–º–¥—Ä–∞–ª
    const MAX_DISC = 0.15;      // max 15%

    // =========================
    // DATA (—Å—É—É—Ä—å “Ø–Ω—ç = 1GB / 1 ”©–¥”©—Ä, MNT)
    // + Unlimited-–∏–π–Ω —Å—É—É—Ä—å “Ø–Ω—ç (unl_mnt) –±–∞–π–≤–∞–ª —è–≥ —Ç“Ø“Ø–≥—ç—ç—Ä –±–æ–¥–Ω–æ
    // =========================
    const ESIM_BASES = [
      { id:"asia10",  name:"Asia (10 —É–ª—Å)",   flag:"üåè", base_mnt:3000, unl_mnt:7500, note:"–ê–∑–∏–π–Ω 10 —É–ª—Å–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞" },
      { id:"eu_multi",name:"–ï–≤—Ä–æ–ø (EU ‚Äì –æ–ª–æ–Ω —É–ª—Å)", flag:"üá™üá∫", base_mnt:3800, unl_mnt:8800, note:"–ï–≤—Ä–æ–ø—ã–Ω –æ–ª–æ–Ω —É–ª—Å–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞ (–±–∞—Ä–∏–º–∂–∞–∞)" },
      { id:"global66",name:"Global (66 —É–ª—Å)", flag:"üåç", base_mnt:5000, unl_mnt:9500, note:"–î—ç–ª—Ö–∏–π–Ω 66 —É–ª—Å–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞" },

      { id:"cn", name:"–•—è—Ç–∞–¥",      iso:"CN", base_mnt:2000, unl_mnt:6500, note:"Facebook, Google VPN-–≥“Ø–π (HK routed)" },
      { id:"jp", name:"–Ø–ø–æ–Ω",       iso:"JP", base_mnt:2000, unl_mnt:6000 },
      { id:"sg", name:"–°–∏–Ω–≥–∞–ø—É—Ä",   iso:"SG", base_mnt:700,  unl_mnt:3500 },
      { id:"my", name:"–ú–∞–ª–∞–π–∑",     iso:"MY", base_mnt:1030, unl_mnt:4200 },
      { id:"id", name:"–ò–Ω–¥–æ–Ω–µ–∑",    iso:"ID", base_mnt:2052, unl_mnt:6400 },
      { id:"th", name:"–¢–∞–π–ª–∞–Ω–¥",    iso:"TH", base_mnt:1240, unl_mnt:4800 },
      { id:"vn", name:"–í—å–µ—Ç–Ω–∞–º",    iso:"VN", base_mnt:1133, unl_mnt:4500 },
      { id:"us", name:"–ê–ù–£ (USA)",  iso:"US", base_mnt:1700, unl_mnt:6200 },

      { id:"de", name:"–ì–µ—Ä–º–∞–Ω",     iso:"DE", base_mnt:2000, unl_mnt:6800 },
      { id:"fr", name:"–§—Ä–∞–Ω—Ü",      iso:"FR", base_mnt:2000, unl_mnt:6800 },
      { id:"it", name:"–ò—Ç–∞–ª–∏",      iso:"IT", base_mnt:1900, unl_mnt:6500 },
      { id:"es", name:"–ò—Å–ø–∞–Ω–∏",     iso:"ES", base_mnt:1900, unl_mnt:6500 },
      { id:"gb", name:"–ò—Ö –ë—Ä–∏—Ç–∞–Ω–∏", iso:"GB", base_mnt:2200, unl_mnt:7200 }
    ];

    // =========================
    // Helpers
    // =========================
    const fmt = n => new Intl.NumberFormat('mn-MN').format(Math.round(n)) + "‚ÇÆ";

    function flagFromISO(iso){
      if(!iso) return "";
      const cc = iso.toUpperCase();
      if(!/^[A-Z]{2}$/.test(cc)) return "";
      const A = 0x1F1E6;
      return String.fromCodePoint(...[...cc].map(c => A + c.charCodeAt(0) - 65));
    }
    function itemFlag(item){
      return item.flag || flagFromISO(item.iso) || "";
    }

    function calc(basePerDay, days){
      const disc = Math.min((days - 1) * DAILY_DISC, MAX_DISC);
      const baseCalc = basePerDay * days * (1 - disc);
      const sell = baseCalc * (1 + PROFIT);
      return { sell };
    }

    function planLabel(p){
      return (p === "unl") ? "Unlimited" : (p + "GB");
    }

    // Unlimited —Å—É—É—Ä—å “Ø–Ω—ç –±–∞–π—Ö–≥“Ø–π –±–æ–ª —Ç“Ø—Ä –±–∞—Ä–∏–º–∂–∞–∞: 1GB * 4
    function baseForPlan(item, plan){
      if(plan === "unl"){
        return item.unl_mnt ?? Math.round(item.base_mnt * 4);
      }
      return item.base_mnt * Number(plan); // 1/2/3
    }

    function showToast(msg="–•—É—É–ª–ª–∞–∞ ‚úÖ"){
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.style.display = "block";
      clearTimeout(showToast._tm);
      showToast._tm = setTimeout(()=> t.style.display="none", 1400);
    }

    // =========================
    // DOM
    // =========================
    const grid = document.getElementById("grid");
    const q = document.getElementById("q");
    const daysEl = document.getElementById("days");

    const bd = document.getElementById("bd");
    const md = document.getElementById("md");
    const ttl = document.getElementById("ttl");
    const out = document.getElementById("out");
    const orderBtn = document.getElementById("order");

    const modalDaysEl = document.getElementById("modalDays");
    const dayChips = document.getElementById("dayChips");

    const modalPlanEl = document.getElementById("modalPlan");
    const dataChips = document.getElementById("dataChips");

    // Fill days 1..30 (page)
    for(let d=1; d<=30; d++){
      const opt = document.createElement("option");
      opt.value = d;
      opt.textContent = d + " ”©–¥”©—Ä";
      daysEl.appendChild(opt);
    }
    daysEl.value = "7";

    // Fill modal days 1..30
    for(let d=1; d<=30; d++){
      const opt = document.createElement("option");
      opt.value = d;
      opt.textContent = d + " ”©–¥”©—Ä";
      modalDaysEl.appendChild(opt);
    }

    let currentItem = null;
    let currentPlan = "1";

    function setActiveDays(days){
      dayChips.querySelectorAll(".pill").forEach(b=>{
        b.classList.toggle("active", Number(b.dataset.d) === Number(days));
      });
    }
    function setActivePlan(plan){
      currentPlan = plan;
      modalPlanEl.value = plan;
      dataChips.querySelectorAll(".pill").forEach(b=>{
        b.classList.toggle("active", b.dataset.plan === String(plan));
      });
    }

    function updateModalPrice(){
      if(!currentItem) return;

      const days = Number(modalDaysEl.value) || 7;
      const plan = String(modalPlanEl.value || currentPlan || "1");

      const basePerDay = baseForPlan(currentItem, plan);
      const r = calc(basePerDay, days);

      ttl.textContent = `${itemFlag(currentItem)} ${currentItem.name} ‚Äì ${planLabel(plan)} ‚Ä¢ ${days} ”©–¥”©—Ä`;

      out.innerHTML = `
        –°—É—É—Ä—å “Ø–Ω—ç (${planLabel(plan)}/1”©–¥”©—Ä): <b>${fmt(basePerDay)}</b><br/>
        –¢–∞–Ω—ã —Å–æ–Ω–≥–æ—Å–æ–Ω –¥“Ø–Ω: <b style="font-size:18px">${fmt(r.sell)}</b>
        ${currentItem.note ? `<div style="margin-top:10px"><b>–¢–∞–π–ª–±–∞—Ä:</b> ${currentItem.note}</div>` : ``}
      `;

      setActiveDays(days);
      setActivePlan(plan);
    }

    function openModal(item){
      currentItem = item;
      modalDaysEl.value = String(Number(daysEl.value) || 7);
      setActivePlan("1");
      updateModalPrice();
      bd.style.display="block";
      md.style.display="block";
    }

    function closeModal(){
      bd.style.display="none";
      md.style.display="none";
    }

    // Featured helpers
    window.quickOpen = function(id){
      const item = ESIM_BASES.find(x => x.id === id) || ESIM_BASES[0];
      openModal(item);
      return false;
    };

    // Modal events
    document.getElementById("x").onclick = closeModal;
    document.getElementById("cancel").onclick = closeModal;
    bd.onclick = closeModal;
    document.addEventListener("keydown", e => { if(e.key==="Escape") closeModal(); });

    dayChips.addEventListener("click", (e)=>{
      const btn = e.target.closest("button[data-d]");
      if(!btn) return;
      modalDaysEl.value = btn.dataset.d;
      updateModalPrice();
    });
    modalDaysEl.addEventListener("change", updateModalPrice);

    dataChips.addEventListener("click", (e)=>{
      const btn = e.target.closest("button[data-plan]");
      if(!btn) return;
      setActivePlan(btn.dataset.plan);
      updateModalPrice();
    });
    modalPlanEl.addEventListener("change", ()=>{
      setActivePlan(modalPlanEl.value);
      updateModalPrice();
    });

    // –ó–∞—Ö–∏–∞–ª–∞—Ö: Messenger —Ä“Ø“Ø “Ø—Å—Ä—ç—Ö–≥“Ø–π ‚Äî —Å–æ–Ω–≥–æ–ª—Ç—ã–≥ clipboard-–¥ —Ö—É—É–ª–Ω–∞
    orderBtn.addEventListener("click", async ()=>{
      if(!currentItem) return;
      const days = Number(modalDaysEl.value) || 7;
      const plan = String(modalPlanEl.value || currentPlan || "1");
      const basePerDay = baseForPlan(currentItem, plan);
      const r = calc(basePerDay, days);

      const msg =
`–ó–∞—Ö–∏–∞–ª–≥–∞:
–£–ª—Å/–ë“Ø—Å: ${itemFlag(currentItem)} ${currentItem.name}
–î–∞—Ç–∞: ${planLabel(plan)}
–•—É–≥–∞—Ü–∞–∞: ${days} ”©–¥”©—Ä
–î“Ø–Ω: ${fmt(r.sell)}
–£—Ç–∞—Å: 90283039
Facebook: https://www.facebook.com/profile.php?id=61587287992719`;

      try{
        await navigator.clipboard.writeText(msg);
        showToast("–ó–∞—Ö–∏–∞–ª–≥—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ö—É—É–ª–ª–∞–∞ ‚úÖ");
      }catch(err){
        // fallback: select text
        const tmp = document.createElement("textarea");
        tmp.value = msg;
        document.body.appendChild(tmp);
        tmp.select();
        document.execCommand("copy");
        tmp.remove();
        showToast("–•—É—É–ª–ª–∞–∞ ‚úÖ");
      }
    });

    // Page controls
    document.getElementById("clear").onclick = ()=>{ q.value=""; render(); };
    q.addEventListener("input", render);
    daysEl.addEventListener("change", render);

    document.getElementById("quickChinaBtn").addEventListener("click", ()=>{
      const item = ESIM_BASES.find(x => x.id === "cn") || ESIM_BASES[0];
      openModal(item);
    });

    function render(){
      const query = (q.value || "").trim().toLowerCase();
      const days = Number(daysEl.value) || 7;

      const list = ESIM_BASES
        .filter(x => !query || (x.name || "").toLowerCase().includes(query))
        .map(x => {
          const price = calc(baseForPlan(x, "1"), days).sell; // 1GB default
          return {...x, price};
        });

      grid.innerHTML = list.map(x => `
        <div class="card">
          <div class="cardHead">
            <div>
              <div class="name">${itemFlag(x)} ${x.name}</div>
              <div class="sub">“Æ–Ω—ç (${days} ”©–¥”©—Ä ‚Ä¢ 1GB): <b>${fmt(x.price)}</b></div>
            </div>
            <button class="btn primary" type="button" data-id="${x.id}">“Æ–Ω—ç —Ö–∞—Ä–∞—Ö</button>
          </div>
          ${x.note ? `<div class="note">${x.note}</div>` : ``}
        </div>
      `).join("");

      grid.querySelectorAll("button[data-id]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const id = btn.getAttribute("data-id");
          const item = ESIM_BASES.find(i => i.id === id);
          if(item) openModal(item);
        });
      });
    }


    // =========================
    // // =========================
// QPay integration (Netlify Functions)
// =========================
const qpayBtn = document.getElementById("payQpay");
const qpayBox = document.getElementById("qpayBox");
const chatBtns = document.getElementById("chatBtns");
const goMessenger = document.getElementById("goMessenger");
const goWhatsapp = document.getElementById("goWhatsapp");
const checkBtn = document.getElementById("checkPayment");

const FB_PAGE_URL = "https://www.facebook.com/profile.php?id=61587287992719";
const WHATSAPP_NUMBER = "97690283039";

window._invoiceId = null;
window._orderMsg = null;

function extractPayUrl(data){
  if(!data) return "";

  if (Array.isArray(data.urls)) {
    return data.urls.find(u => u?.link)?.link || "";
  }

  if (typeof data.urls === "object") {
    return data.urls.qPay || data.urls.qpay || data.urls.link || "";
  }

  return data.qpay_url || data.payment_url || data.link || "";
}

function extractQrValue(data){
  // Prefer raw qr text / deep link that QPay apps can open.
  return (
    data?.qr_text ||
    data?.qrText ||
    data?.qr_string ||
    data?.qrString ||
    data?.qr ||
    data?.qrCode ||
    data?.qr_code ||
    // Sometimes qr text lives under "result"
    data?.result?.qr_text ||
    data?.result?.qrText ||
    data?.result?.qr_string ||
    // Fallback to any payable deep link
    extractPayUrl(data)
  );
}

function extractQrImage(data){
  // Base64 QR image (no prefix) returned by some QPay endpoints
  return (
    data?.qr_image ||
    data?.qrImage ||
    data?.qr_img ||
    data?.qrImg ||
    data?.result?.qr_image ||
    data?.result?.qrImage
  );
}


function resetPayUI(){
  qpayBox.innerHTML = "";
  chatBtns.style.display = "none";
  window._invoiceId = null;
  window._orderMsg = null;
}

qpayBtn.addEventListener("click", async () => {

  if(!currentItem) return;

  const days = Number(modalDaysEl.value) || 7;
  const plan = String(modalPlanEl.value || currentPlan || "1");
  const basePerDay = baseForPlan(currentItem, plan);
  const r = calc(basePerDay, days);

  const orderId = "ESIM_" + Date.now();
  const desc = `${itemFlag(currentItem)} ${currentItem.name} ‚Ä¢ ${planLabel(plan)} ‚Ä¢ ${days} ”©–¥”©—Ä`;

  resetPayUI();
  qpayBox.innerHTML = "‚è≥ QPay –Ω—ç—Ö—ç–º–∂–ª—ç–ª “Ø“Ø—Å–≥—ç–∂ –±–∞–π–Ω–∞...";

  try{
    const res = await fetch("/.netlify/functions/qpay-create-invoice", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        orderId,
        amount: Math.round(r.sell),
        description: desc
      })
    });

    const data = await res.json();
    if(!res.ok) throw new Error(data.error || "QPay error");

    const payUrl = extractPayUrl(data);
    const qrValue = extractQrValue(data);
    const qrImage = extractQrImage(data);

    window._invoiceId = data.invoice_id || null;

    const msg =
`–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É üëã
–ë–∏ QPay-—Ä —Ç”©–ª–±”©—Ä”©”© —Ç”©–ª—Å”©–Ω.
Order: ${orderId}
–ë–∞–≥—Ü: ${desc}
–î“Ø–Ω: ${fmt(r.sell)}
Invoice: ${window._invoiceId || "-"}`;

    window._orderMsg = msg;

    goMessenger.href = FB_PAGE_URL;
    goWhatsapp.href = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;

    qpayBox.innerHTML = `
      <div style="
        display:flex;
        justify-content:center;
        align-items:center;
        padding:14px;
        background:#fff;
        border-radius:16px;
      ">
        <div id="qpayQr"></div>
      </div>
    `;

    const qrDiv = document.getElementById("qpayQr");
    if(qrImage){
      // Render base64 PNG QR image if provided
      const img = document.createElement("img");
      img.alt = "QPay QR";
      img.style.width = "360px";
      img.style.height = "360px";
      img.src = String(qrImage).startsWith("data:")
        ? String(qrImage)
        : `data:image/png;base64,${String(qrImage)}`;
      qrDiv.innerHTML = "";
      qrDiv.appendChild(img);
    }else if(qrValue){
      // Generate QR from text / deep link
      qrDiv.innerHTML = "";
      new QRCode(qrDiv, {
        text: String(qrValue),
        width: 360,
        height: 360
      });
    }else{
      qrDiv.innerHTML = "<div class='sub'>‚ö†Ô∏è QR –º—ç–¥—ç—ç–ª—ç–ª –∏—Ä—Å—ç–Ω–≥“Ø–π. –î–æ–æ—Ä—Ö 'QPay –Ω—ç—ç–∂ —Ç”©–ª”©—Ö' –ª–∏–Ω–∫—ç—ç—Ä —Ç”©–ª–∂ –±–æ–ª–Ω–æ.</div>";
    }

  }catch(e){
    const msg = (e && e.message) ? e.message : String(e);
    qpayBox.innerHTML = `‚ùå QPay –Ω—ç—Ö—ç–º–∂–ª—ç–ª “Ø“Ø—Å–≥—ç—Ö—ç–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞.<div class="sub" style="margin-top:6px">–î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π: <b>${msg}</b></div>`;
    console.error("QPay create invoice error:", e);
  }
});

checkBtn.addEventListener("click", async () => {

  if(!window._invoiceId){
    alert("–≠—Ö–ª—ç—ç–¥ QPay-—Ä —Ç”©–ª”©—Ö –¥—ç—ç—Ä –¥–∞—Ä–Ω–∞ —É—É.");
    return;
  }

  qpayBox.innerHTML = "‚è≥ –¢”©–ª–±”©—Ä —à–∞–ª–≥–∞–∂ –±–∞–π–Ω–∞...";

  try{
    const res = await fetch("/.netlify/functions/qpay-check", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ invoice_id: window._invoiceId })
    });

    const data = await res.json();
    if(!res.ok) throw new Error();

    if(data.paid){
      chatBtns.style.display = "flex";
      qpayBox.innerHTML = `
        <div style="border:1px solid #e5e7eb;border-radius:14px;padding:12px">
          <b>‚úÖ –¢”©–ª–±”©—Ä –∞–º–∂–∏–ª—Ç—Ç–∞–π</b>
          <div class="sub" style="margin-top:8px">
            WhatsApp —ç—Å–≤—ç–ª Facebook Page-—Ä ‚Äú–¢”©–ª–ª”©”©‚Äù –≥—ç–∂ –±–∏—á–Ω—ç “Ø“Ø.
          </div>
        </div>
      `;
    }else{
      qpayBox.innerHTML = `
        <div style="border:1px solid #e5e7eb;border-radius:14px;padding:12px">
          <b>‚è≥ –¢”©–ª–±”©—Ä —Ö–∞—Ä–∞–∞—Ö–∞–Ω –æ—Ä–æ–æ–≥“Ø–π</b>
        </div>
      `;
    }

  }catch(e){
    qpayBox.innerHTML = "‚ùå –¢”©–ª–±”©—Ä —à–∞–ª–≥–∞—Ö–∞–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞.";
  }
});

    render();
(function () {
  const params = new URLSearchParams(window.location.search);
  const plan = params.get("plan");
  if (plan && typeof quickOpen === "function") {
    setTimeout(() => quickOpen(plan), 300);
  }
})();

  </script>
</body>
</html>
